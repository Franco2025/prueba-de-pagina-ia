<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta
    name="viewport"
    content="width=device-width, initial-scale=1, viewport-fit=cover"
  />
  <title>FM Auténtica - estilo + actitud</title>

  <!-- Favicon -->
  <link rel="icon" href="marca-de-agua.icon.ico" type="image/x-icon" />

  <!-- Fuente moderna -->
  <link
    href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap"
    rel="stylesheet"
  />

  <!-- Íconos -->
  <link
    rel="stylesheet"
    href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
  />

  <link rel="stylesheet" href="stylesheet.css" />
</head>
<body>
  <!-- Header (franja completa) -->
  <header>
    <div class="container">
      <h1>FM Auténtica</h1>
      <p>estilo + actitud</p>
    </div>
  </header>

  <main class="container">
    <!-- Bienvenida -->
    <section class="welcome">
      <h2>Bienvenidos a FM Auténtica</h2>
      <p>Donde el estilo y la actitud suenan fuerte</p>
    </section>

    <!-- Audio Player -->
    <section class="audio-player">
      <h2><i class="fa-solid fa-music"></i> Escuchá nuestra radio</h2>
      <button id="playButton" aria-live="polite">
        <i class="fa-solid fa-play"></i> Reproducir
      </button>
      <!-- Controlamos el src por JS para pegar al “vivo” -->
      <audio id="radioPlayer" preload="none"></audio>
    </section>

    <!-- Kick -->
    <section class="kick-button">
      <h2><i class="fa-solid fa-video"></i> Transmisión en vivo</h2>
      <a href="https://kick.com/radiosecuencia" target="_blank" rel="noopener">
        <i class="fa-solid fa-tv"></i> Ver en Kick
      </a>
    </section>

    <!-- Contacto -->
    <section class="contacto">
      <h2><i class="fa-solid fa-message"></i> Contacto</h2>
      <a href="https://wa.me/542215087256" target="_blank" rel="noopener" class="whatsapp">
        <i class="fa-brands fa-whatsapp"></i> WhatsApp
      </a>
    </section>

    <!-- Redes sociales -->
    <section class="social-links">
      <h2><i class="fa-solid fa-hashtag"></i> Seguinos</h2>
      <div class="social-container">
        <a
          href="https://www.instagram.com/fmautentica88.1/"
          target="_blank"
          rel="noopener"
          class="instagram"
        >
          <i class="fa-brands fa-instagram"></i> Instagram
        </a>
        <a
          href="https://www.facebook.com/profile.php?id=100063476626229"
          target="_blank"
          rel="noopener"
          class="facebook"
        >
          <i class="fa-brands fa-facebook"></i> Facebook
        </a>
      </div>
    </section>
  </main>

  <footer>
    <div class="container">
      <p>&copy; 2025 FM Auténtica - Todos los derechos reservados</p>
    </div>
  </footer>

  <script>
    const STREAM_URL = 'https://server6.hostradios.com/8184/stream';
    const playButton = document.getElementById('playButton');
    const radioPlayer = document.getElementById('radioPlayer');

    // Estado del player
    const STATE = {
      IDLE: 'idle',
      CONNECTING: 'connecting',
      PLAYING: 'playing'
    };
    let state = STATE.IDLE;

    function setButton(labelHTML, disabled = false) {
      playButton.innerHTML = labelHTML;
      playButton.disabled = disabled;
      playButton.classList.toggle('is-loading', disabled);
      playButton.setAttribute('aria-busy', disabled ? 'true' : 'false');
    }

    function toIdle() {
      state = STATE.IDLE;
      setButton('<i class="fa-solid fa-play"></i> Reproducir', false);
    }

    function toConnecting() {
      state = STATE.CONNECTING;
      // feedback INSTANTÁNEO
      setButton('<i class="fa-solid fa-spinner fa-spin"></i> Conectando…', true);
    }

    function toPlaying() {
      state = STATE.PLAYING;
      setButton('<i class="fa-solid fa-stop"></i> Detener', false);
    }

    function startStream() {
      // bust cache para pegar al vivo
      radioPlayer.src = STREAM_URL + '?t=' + Date.now();
      radioPlayer.load();
      return radioPlayer.play();
    }

    function stopStream() {
      radioPlayer.pause();
      radioPlayer.removeAttribute('src'); // limpia buffer
      radioPlayer.load();
    }

    // Click del botón
    playButton.addEventListener('click', () => {
      if (state === STATE.PLAYING) {
        // Detener
        stopStream();
        toIdle();
        return;
      }

      // Iniciar: cambiamos UI AL INSTANTE
      toConnecting();
      startStream()
        .then(() => {
          // algunos navegadores tardan en disparar 'playing'; damos feedback ya
          toPlaying();
        })
        .catch(() => {
          stopStream();
          toIdle();
        });
    });

    // Si el navegador avisa que está realmente reproduciendo
    radioPlayer.addEventListener('playing', () => {
      if (state === STATE.CONNECTING) toPlaying();
    });

    // Reintentos suaves si se corta estando en PLAYING
    ['stalled', 'ended', 'error'].forEach(evt => {
      radioPlayer.addEventListener(evt, () => {
        if (state === STATE.PLAYING) {
          // Intento silencioso de reenganchar al vivo
          startStream().catch(() => {
            // Si no vuelve, quedamos en idle
            stopStream();
            toIdle();
          });
        }
      });
    });
  </script>
</body>
</html>

